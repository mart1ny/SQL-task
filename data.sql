-- Задание 2: заполнение данными (минимум 20 записей в каждой таблице)
-- Все INSERT сгруппированы по таблицам и выполняются в транзакции.
START TRANSACTION;

-- Пользователи (users) — 20 клиентов из разных городов
INSERT INTO users (username, email, registration_date, city, total_orders, total_spent) VALUES
('анна', 'anna@example.ru', '2022-11-05', 'Москва', 15, 1850.40),
('богдан', 'bogdan@example.ru', '2022-12-12', 'Санкт-Петербург', 18, 2145.60),
('виктория', 'viktoria@example.ru', '2023-01-20', 'Новосибирск', 11, 1322.15),
('григорий', 'grigoriy@example.ru', '2023-02-02', 'Екатеринбург', 9, 980.35),
('дарья', 'darya@example.ru', '2023-02-19', 'Казань', 6, 745.90),
('егор', 'egor@example.ru', '2023-03-04', 'Челябинск', 14, 1674.00),
('жасмин', 'jasmin@example.ru', '2023-03-25', 'Омск', 7, 812.70),
('зоя', 'zoya@example.ru', '2023-04-01', 'Самара', 13, 1788.55),
('иван', 'ivan@example.ru', '2023-04-15', 'Ростов-на-Дону', 5, 590.20),
('карина', 'karina@example.ru', '2023-05-09', 'Уфа', 10, 1099.99),
('лев', 'lev@example.ru', '2023-05-22', 'Красноярск', 12, 1468.80),
('мария', 'maria@example.ru', '2023-06-02', 'Пермь', 8, 905.45),
('никита', 'nikita@example.ru', '2023-06-18', 'Воронеж', 16, 1932.75),
('оксана', 'oksana@example.ru', '2023-07-01', 'Волгоград', 9, 988.30),
('павел', 'pavel@example.ru', '2023-07-11', 'Краснодар', 6, 702.90),
('рита', 'rita@example.ru', '2023-07-25', 'Саратов', 7, 830.50),
('светлана', 'svetlana@example.ru', '2023-08-05', 'Тюмень', 11, 1210.70),
('тимофей', 'timofey@example.ru', '2023-08-17', 'Тольятти', 10, 1189.80),
('ульяна', 'ulyana@example.ru', '2023-08-28', 'Ижевск', 5, 560.60),
('фёдор', 'fedor@example.ru', '2023-09-06', 'Барнаул', 4, 445.30);

-- Категории товаров (categories) с иерархией
INSERT INTO categories (category_name, parent_category_id) VALUES
('Электроника', NULL),
('Компьютеры', 1),
('Смартфоны', 1),
('Аксессуары', 1),
('Бытовая техника', NULL),
('Кухонная техника', 5),
('Носимая электроника', 1),
('Аудио', 1),
('Игровые устройства', 2),
('Мебель', NULL),
('Товары для улицы', NULL),
('Спортивные гаджеты', 11),
('Умный дом', 5),
('Фототехника', 1),
('Книги', NULL),
('Детские товары', NULL),
('Бьюти-гаджеты', 5),
('Здоровье', NULL),
('Офисные принадлежности', NULL),
('Автоаксессуары', NULL);

-- Товары (products) с характеристиками и принадлежностью к категориям
INSERT INTO products (product_name, category_id, price, stock_quantity, average_rating, created_at) VALUES
('Ультрабук Аэро 13', 2, 899.99, 45, 4.7, '2023-01-15'),
('Игровой ноутбук Титан', 9, 1299.50, 30, 4.9, '2023-02-01'),
('Наушники с шумоподавлением', 8, 199.99, 80, 4.5, '2023-01-28'),
('Смартфон Нова X', 3, 699.00, 100, 4.6, '2023-03-12'),
('Смарт-часы Пульс', 7, 249.90, 120, 4.4, '2023-02-20'),
('Bluetooth-колонка Бум', 8, 149.50, 150, 4.3, '2023-02-02'),
('Экшен-камера 4K', 14, 349.99, 60, 4.2, '2023-03-05'),
('Робот-пылесос CleanPro', 13, 429.00, 55, 4.1, '2023-03-30'),
('Аэрогриль ProCook', 6, 179.99, 70, 4.5, '2023-04-10'),
('Эргономичное офисное кресло', 10, 299.99, 40, 4.0, '2023-04-25'),
('Беспроводная клавиатура Slim', 4, 89.90, 90, 4.2, '2023-05-01'),
('Датчик шума SmartHome', 13, 129.99, 65, 4.1, '2023-05-15'),
('Объектив для DSLR камеры', 14, 599.00, 25, 4.8, '2023-05-18'),
('Умный термостат', 13, 159.99, 75, 4.4, '2023-05-30'),
('Портативный проектор', 1, 499.00, 50, 4.3, '2023-06-05'),
('Фитнес-браслет Pro', 7, 139.50, 110, 4.2, '2023-06-12'),
('Домашний кинотеатр', 8, 899.00, 35, 4.6, '2023-06-25'),
('Электрический стоячий стол', 10, 699.90, 40, 4.5, '2023-07-04'),
('Умная кофеварка', 6, 219.99, 60, 4.3, '2023-07-15'),
('Видеорегистратор Guardian', 20, 159.00, 85, 4.4, '2023-07-28');

-- Заказы (orders) с разными статусами и способами оплаты
INSERT INTO orders (user_id, order_date, total_amount, status, payment_method) VALUES
(1, '2023-08-02 10:15:00', 1024.50, 'delivered', 'карта'),
(2, '2023-08-04 15:20:00', 845.99, 'delivered', 'карта'),
(3, '2023-08-06 12:05:00', 499.49, 'delivered', 'наличные'),
(4, '2023-08-07 14:40:00', 329.90, 'processing', 'карта'),
(5, '2023-08-08 18:10:00', 249.50, 'delivered', 'карта'),
(6, '2023-08-10 09:55:00', 1349.00, 'shipped', 'карта'),
(7, '2023-08-11 13:25:00', 375.80, 'delivered', 'карта'),
(8, '2023-08-12 16:45:00', 980.40, 'delivered', 'карта'),
(9, '2023-08-13 11:05:00', 229.90, 'pending', 'наличные'),
(10, '2023-08-14 19:30:00', 699.99, 'delivered', 'карта'),
(11, '2023-08-16 08:15:00', 899.90, 'delivered', 'карта'),
(12, '2023-08-17 17:35:00', 540.20, 'processing', 'карта'),
(13, '2023-08-18 10:50:00', 1115.75, 'delivered', 'карта'),
(14, '2023-08-19 13:05:00', 455.30, 'delivered', 'наличные'),
(15, '2023-08-20 15:25:00', 329.80, 'shipped', 'карта'),
(16, '2023-08-21 18:45:00', 415.20, 'delivered', 'карта'),
(17, '2023-08-22 09:30:00', 799.40, 'processing', 'карта'),
(18, '2023-08-23 14:10:00', 610.90, 'delivered', 'карта'),
(19, '2023-08-24 20:00:00', 238.70, 'cancelled', 'карта'),
(20, '2023-08-25 11:15:00', 199.95, 'pending', 'наличные');

-- Позиции заказов (order_items) связывают заказы и товары
INSERT INTO order_items (order_id, product_id, quantity, price_at_time) VALUES
(1, 1, 1, 899.99),
(1, 11, 2, 62.25),
(2, 4, 1, 699.00),
(2, 5, 1, 249.90),
(3, 3, 2, 199.99),
(3, 6, 1, 149.50),
(4, 19, 1, 219.99),
(4, 11, 1, 89.90),
(5, 5, 1, 249.90),
(6, 2, 1, 1299.50),
(6, 3, 1, 199.99),
(7, 16, 2, 139.50),
(8, 8, 1, 429.00),
(8, 5, 1, 249.90),
(8, 6, 2, 149.50),
(9, 11, 1, 89.90),
(9, 3, 1, 199.99),
(10, 4, 1, 699.00),
(11, 17, 1, 899.00),
(11, 12, 1, 129.99),
(12, 18, 1, 699.90),
(12, 11, 1, 89.90),
(13, 15, 1, 499.00),
(13, 5, 1, 249.90),
(13, 10, 1, 299.99),
(14, 6, 1, 149.50),
(14, 3, 1, 199.99),
(15, 5, 1, 249.90),
(15, 3, 1, 199.99),
(16, 7, 1, 349.99),
(16, 11, 1, 89.90),
(17, 8, 1, 429.00),
(17, 11, 2, 89.90),
(18, 9, 1, 179.99),
(18, 5, 1, 249.90),
(18, 3, 1, 199.99),
(19, 11, 1, 89.90),
(19, 6, 1, 149.50),
(19, 3, 1, 199.99),
(20, 11, 2, 89.90),
(20, 5, 1, 249.90);

-- Отзывы (reviews), фиксируем рейтинг, текст и полезность
INSERT INTO reviews (user_id, product_id, rating, review_text, created_at, helpful_count) VALUES
(1, 1, 5, 'Отличный ультрабук для поездок.', '2023-08-05 11:00:00', 12),
(2, 4, 4, 'Камера смартфона очень чёткая.', '2023-08-06 13:10:00', 8),
(3, 3, 5, 'Наушники полностью глушат шум.', '2023-08-07 09:00:00', 5),
(4, 5, 3, 'Автономность часов могла бы быть выше.', '2023-08-08 14:30:00', 3),
(5, 6, 4, 'Колонка радует сочным звуком.', '2023-08-09 17:45:00', 4),
(6, 2, 5, 'Этот ноутбук просто зверь в играх!', '2023-08-10 19:25:00', 9),
(7, 8, 4, 'Робот делает уборку без усилий.', '2023-08-11 10:15:00', 6),
(8, 7, 5, 'Камера отлично снимает в путешествиях.', '2023-08-12 13:50:00', 7),
(9, 9, 4, 'Готовлю полезные блюда каждый день.', '2023-08-13 16:05:00', 2),
(10, 10, 5, 'Кресло невероятно удобное.', '2023-08-14 18:20:00', 5),
(11, 11, 4, 'Лаконичный дизайн клавиатуры.', '2023-08-15 07:40:00', 2),
(12, 12, 4, 'Датчик стабильно передаёт показания.', '2023-08-16 11:05:00', 3),
(13, 13, 5, 'Объектив даёт кристально чистую картинку.', '2023-08-17 14:55:00', 11),
(14, 14, 4, 'Температуру дома держит идеально.', '2023-08-18 08:33:00', 4),
(15, 15, 5, 'Проектор яркий даже днём.', '2023-08-19 12:22:00', 5),
(16, 16, 4, 'Фитнес-браслет мотивирует не сдаваться.', '2023-08-20 10:10:00', 3),
(17, 17, 5, 'Домашний кинотеатр дарит эффект присутствия.', '2023-08-21 09:45:00', 8),
(18, 18, 5, 'Стол устойчивый и тихий.', '2023-08-22 16:25:00', 6),
(19, 19, 4, 'Кофеварка готовит напиток в точку.', '2023-08-23 07:35:00', 4),
(20, 20, 4, 'Видеорегистратор снимает ночью без шумов.', '2023-08-24 21:15:00', 2);

-- Исторические ежемесячные отчёты (monthly_reports) — база для процедуры
INSERT INTO monthly_reports (report_month, total_orders, total_revenue, average_order_value, new_users, delivered_orders, cancelled_orders) VALUES
('2023-01-01', 220, 185000.00, 840.91, 120, 200, 5),
('2023-02-01', 240, 198500.00, 827.08, 130, 218, 6),
('2023-03-01', 260, 215300.00, 827.31, 145, 233, 7),
('2023-04-01', 255, 210450.00, 825.29, 138, 225, 8),
('2023-05-01', 270, 225900.00, 837.41, 150, 240, 9),
('2023-06-01', 280, 232100.00, 828.93, 160, 248, 10),
('2023-07-01', 295, 245600.00, 832.54, 170, 260, 12),
('2023-08-01', 310, 258900.00, 835.16, 180, 275, 11),
('2023-09-01', 320, 269500.00, 842.19, 185, 283, 12),
('2023-10-01', 330, 279000.00, 845.45, 190, 290, 13),
('2023-11-01', 340, 288200.00, 848.24, 195, 300, 14),
('2023-12-01', 360, 305000.00, 847.22, 210, 318, 15),
('2024-01-01', 375, 318500.00, 850.67, 215, 330, 16),
('2024-02-01', 365, 310200.00, 850.14, 205, 322, 14),
('2024-03-01', 380, 323900.00, 852.37, 220, 335, 13),
('2024-04-01', 395, 336500.00, 852.53, 225, 348, 12),
('2024-05-01', 410, 349800.00, 853.17, 230, 362, 11),
('2024-06-01', 425, 361200.00, 850.94, 240, 375, 10),
('2024-07-01', 435, 370600.00, 852.07, 245, 383, 9),
('2024-08-01', 450, 382900.00, 850.89, 255, 395, 8);

COMMIT;
